{% extends "base-ancient.html" %}

{% block title %}ç« èŠ‚ç®¡ç† - {{ novel.title }}{% endblock %}

{% block content %}
<h1 class="page-title" style="text-align: left;">ğŸ“š ç« èŠ‚ç®¡ç†ï¼š{{ novel.title }}</h1>

<div style="margin-bottom: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
    <a href="{{ url_for('creator_add_chapter', novel_id=novel._id) }}" class="btn btn-success">â• æ·»åŠ ç« èŠ‚</a>
    <a href="{{ url_for('creator_import_chapters', novel_id=novel._id) }}" class="btn btn-primary">ğŸ“¥ å¯¼å…¥ç« èŠ‚</a>
    {% if novel.status == 'draft' and novel.chapters|length > 0 %}
    <form method="POST" action="{{ url_for('creator_submit_novel', novel_id=novel._id) }}" style="display: inline;">
        <button type="submit" class="btn btn-warning" onclick="return confirm('ç¡®å®šè¦æäº¤å®¡æ ¸å—ï¼Ÿ')">ğŸ“¤ æäº¤å®¡æ ¸</button>
    </form>
    {% endif %}
    <a href="{{ url_for('creator_edit_novel', novel_id=novel._id) }}" class="btn btn-secondary">è¿”å›ç¼–è¾‘</a>
</div>

<div class="card">
    <div class="card-header" style="font-size: 1.1rem;">
        ğŸ“– ç« èŠ‚åˆ—è¡¨ï¼ˆå…± {{ novel.chapters|length }} ç« ï¼‰
    </div>
    
    {% if novel.chapters %}
    <ul style="list-style: none; padding: 0; margin: 0;">
        {% for chapter in novel.chapters %}
        <li style="display: flex; justify-content: space-between; align-items: center; padding: 1.25rem 1.5rem; border-bottom: 1px solid #f0e6d6; transition: all 0.3s; {% if loop.last %}border-bottom: none;{% endif %}"
            onmouseover="this.style.background='#faf8f3'"
            onmouseout="this.style.background='transparent'">
            <div>
                <strong style="color: #5a4a3a; font-size: 1rem; margin-right: 0.75rem;">{{ chapter.title }}</strong>
                {% if chapter.isFree %}
                <span class="badge badge-success">å…è´¹</span>
                {% else %}
                <span class="badge badge-warning">ä»˜è´¹</span>
                {% endif %}
                <span style="color: #8b7355; font-size: 0.9rem; margin-left: 1rem;">
                    ğŸ“… {{ chapter.createTime.strftime('%Y-%m-%d') if chapter.createTime else '-' }}
                </span>
            </div>
            <div style="display: flex; gap: 0.75rem;">
                <a href="{{ url_for('creator_edit_chapter', novel_id=novel._id, chapter_id=chapter.chapterId) }}" class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">ç¼–è¾‘</a>
                <form method="POST" action="{{ url_for('creator_delete_chapter', novel_id=novel._id, chapter_id=chapter.chapterId) }}" style="display: inline;">
                    <button type="submit" class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.9rem; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);" onclick="return confirm('ç¡®å®šè¦åˆ é™¤æ­¤ç« èŠ‚å—ï¼Ÿ')">åˆ é™¤</button>
                </form>
            </div>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <div class="empty-state">
        <div class="icon">ğŸ“–</div>
        <h3>è¿˜æ²¡æœ‰æ·»åŠ ç« èŠ‚</h3>
        <p>å¼€å§‹æ·»åŠ æ‚¨çš„ç²¾å½©å†…å®¹å§ï¼</p>
        <a href="{{ url_for('creator_add_chapter', novel_id=novel._id) }}" class="btn btn-primary">ç«‹å³æ·»åŠ </a>
    </div>
    {% endif %}
</div>
{% endblock %}
